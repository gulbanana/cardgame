@inject IUserSession Session
@code {
    [Parameter] public GameModel Game { get; set; }
    [Parameter] public string Id { get; set; }
    [CascadingParameter] public Executor Dispatch { get; set; }
}

@if (Game.Supply[Id] > 0)
{
    var isEnabled = Session.Username.Equals(Game.ActivePlayer) &&
        !Game.IsFinished &&
        Game.ExecutingActions == 0 &&
        Game.BuysRemaining > 0 &&
        Cards.All.Exists(Id) &&
        Cards.All.ByName(Id).Cost <= Game.MoneyRemaining;
    <ActiveCard Id="@Id" 
                Enabled="isEnabled" 
                Half="true" 
                Stack="@Game.Supply[Id]"
                Action="@(() => Dispatch(new BuyCardCommand { Id = Id }))" />
}
else
{
    <SpecialCard Name="randomizer" Half="true" Stack="1" />
}